$(document).ready(function(){var T=CONFIG.sidebar&&CONFIG.sidebar.tocMaxDepth||4,l="h1,h2,h3,h4,h5,h6,".slice(0,T*3).slice(0,-1);function m(){$(".post-body, .custompage").find(l)[0]||($(".sidebar-nav").addClass("hide"),$(".sidebar-toc").addClass("hide"),$(".sidebar-ov").removeClass("hide"))}var s=null,v=null,d=!1;function p(){var e=$(".post-body, .custompage"),r=$(".sidebar-toc li"),o=e.find(l),a=o.first();if(o.each(function(){var i=this.getBoundingClientRect().top,c=5;i<=c&&(s=window.encodeURIComponent(this.getAttribute("id")))}),e[0]&&a[0]&&a[0].getBoundingClientRect().top>0&&a.offset().top-$(window).scrollTop()>0){d||(r.removeClass("active current"),d=!0);return}if(s!==v){var t=$('.sidebar-toc a[href="#'+s+'"]');if(!t.length){var n=window.decodeURIComponent(s);t=$('.sidebar-toc a[href="#'+n+'"]')}r.removeClass("active current"),t.parents("li").addClass("active"),t.parent().addClass("current"),v=s,d=!1}}var f=!1;function u(){var e=$(".sidebar-toc").height(),r=$(".sidebar-toc > div").height();if(!(r<=e)){var o=$(".sidebar-toc"),a=$(".sidebar-toc .current a");if(a[0]&&o[0]){var t=a.offset().top-o.offset().top;f=t>e||t<0}f&&a.velocity("stop").velocity("scroll",{container:o,offset:-e/2,duration:500,easing:"easeOutQuart"})}}var h=0;CONFIG.sidebar&&CONFIG.sidebar.offsetTop&&(h=parseInt(CONFIG.sidebar.offsetTop));function b(){var e=$("#sidebar"),r=document.getElementById("content-wrap").getBoundingClientRect().top;r<h?e.addClass("sidebar--sticky"):e.removeClass("sidebar--sticky")}function g(){if($("#is-post").length!==0){var e=$(".content"),r=e.offset().top,o=0,a=0,t=0,n=!1,i=0;CONFIG.postWidget&&CONFIG.postWidget.endText&&(n=!0),n?(o=$(".post-ending").offset().top,a=$(".post-ending").outerHeight(),t=o-r+a):(o=$(".post-footer").offset().top,t=o-r);var c=$(window).height(),C=0;e.length!==0&&(C=parseInt(e[0].getBoundingClientRect().top*-1)+c);var y=Number($(".sidebar-reading-info__num").text());t=parseInt(Math.abs(t)),i=parseInt(C/t*100),i=i>100?100:i<0?0:i,!(i===0&&y===0||i===100&&y===100)&&($(".sidebar-reading-info__num").text(i),$(".sidebar-reading-line").css("transform","translateX("+(i-100)+"%)"))}}p(),b(),u(),g(),$(window).on("scroll",function(){b()}),$(window).on("scroll",Stun.utils.throttle(function(){p(),u(),g()},150)),Stun.utils.pjaxReloadSidebar=function(){var e=$(".sidebar-nav-toc"),r=$(".sidebar-nav-ov"),o=$(".sidebar-toc"),a=$(".sidebar-ov");e.on("click",function(t){t.stopPropagation(),!$(this).hasClass("current")&&(e.addClass("current"),r.removeClass("current"),o.css("display","block"),o.velocity("stop").velocity("fadeIn"),a.css("display","none"),a.velocity("stop").velocity("fadeOut"))}),r.on("click",function(t){t.stopPropagation(),!$(this).hasClass("current")&&(r.addClass("current"),e.removeClass("current"),o.css("display","none"),o.velocity("stop").velocity("fadeOut"),a.css("display","block"),a.velocity("stop").velocity("fadeIn"))}),m()},Stun.utils.pjaxReloadSidebar()});
